<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
      <!-- 06.03. 변수의 유효범위와 클로저 -->
       <Script>
        // 01. 함수가 최신 변경 사항을 반영할까요?

        // 내 답안
        // 01. sayHi()함수가 실행되면서 먼저 매개변수를 할당한다. 매개변수가 없으므로 할당x
        // 02. function sayHi()가 환경 레코드에 할당되면서, 실행된다. 이때 name변수도 "보라"로 할당된다
        // 03. 보라님 안녕하세요 가 출력된다
        // 04. name에 지민이 할당된다

        // 정답
        // 01. 초기 렉시컬 환경 구성
        // let name = "보라"; 이 구문이 실행되면, 렉시컬 환경에 name 변수가 "보라"로 등록
        // 함수 sayHi가 선언되면서, sayHi는 실행되지 않지만, 이때 [[Environment]]라는 숨겨진 프로퍼티에 함수가 정의될 당시의 렉시컬 환경이 저장
        // 즉, 이 시점에서 [[Environment]]는 name = "보라"인 렉시컬 환경을 기억
        
        // 02. name 변수 업데이트
        // name = "지민"; 이 구문이 실행되면, 현재 렉시컬 환경에서 name의 값이 "지민"으로 업데이트
        // 기존 "보라"는 사라지고, 이제 name 변수는 "지민"을 가리킴

        // 03. sayHi 함수 실행
        // sayHi()를 호출하면, 함수 내부에서 name 변수를 참조할 때 [[Environment]]를 사용해 그 변수를 찾음
        // 그러나 중요한 점은 함수가 호출될 때가 아니라, 정의될 때의 렉시컬 환경을 참조하는 것이 아니라, 
        // 현재의 렉시컬 환경을 참조한다는 것

        // 따라서, name 변수는 현재 "지민"으로 설정되어 있으므로, "지민님, 안녕하세요."가 출력됨.

        // [[Environment]] 역할
        // [[Environment]]는 sayHi 함수가 정의된 시점의 외부 렉시컬 환경을 참조하고, 이는 호출 시에 변수를 탐색하는 데 사용됩니다. 이 프로퍼티 덕분에, 함수가 어느 렉시컬 환경에서 호출되든 정의된 당시의 외부 환경을 기억하고 접근할 수 있습니다.
       </Script>
</body>
</html>